<% title "Confirm your email" %>
<% proper_email = params[:email] || (resource.pending_reconfirmation? ? resource.unconfirmed_email : resource.email) %>
<% if FeatureFlag.enabled?(:creator_onboarding) %>
  <div class="crayons-layout crayons-layout--limited-l">
    <div class="flex flex-col items-center">
      <%= inline_svg_tag("mail.svg", aria: true, title: "Email") %>
      <div class="fs-3xl fw-bold">Great! Now confirm your email address.</div>

      <div class="fs-xl color-base-70">
        <div>We've sent an email to <span class="fw-bold"><%= proper_email %></span></div>
        <div>Click the button inside to confirm your email</div>
      </div>
    </div>
    <div class="bg-base-10 p-4 m-auto">
      <span onclick="window.Forem.showModal({
        contentSelector: '#confirm-email-modal',
        overlay: true,
      })"> Click here</span> if you didnt get the email
    </div>
  </div>

  <div id="confirm-email-modal" class="hidden">
    <div>Didn't get thhe email?</div>
    <div>Re-enter the email address to resent the confirmation link</div>

    <%= form_for(resource, as: resource_name, url: confirmation_path(resource_name), html: { method: :post }, data: { testid: "resend-confirmation-form" }) do |f| %>
      <%= render "devise/shared/error_messages", resource: resource %>

      <div class="crayons-field mt-2">
        <%= f.email_field :email, tgclass: "crayons-textfield", aria: { label: "Confirmation email address" }, autofocus: false, value: proper_email %>
      </div>

      <div class="crayons-field mt-2">
        <%= f.submit "Resend", class: "crayons-btn mr-1" %>
        <%= f.submit "Dismiss", class: "crayons-btn crayons-btn--secondary", id: "cancel-btn" %>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="crayons-layout crayons-layout--limited-l align-center mt-9 mb-10 p-3">
    <h1 class="fs-5xl mb-5">Welcome to <%= community_name %>! ðŸŽ‰</h1>
    <h3 class="mb-5">A confirmation email has been sent to <a href="mailto:<%= proper_email %>"><%= proper_email %></a></h3>
    <div class="mt-8 mb-6 crayons-card p-7 align-left mx-auto">
      <h2 class="pb-4">Didn't get the email?</h2>
      <%= form_for(resource, as: resource_name, url: confirmation_path(resource_name), html: { method: :post }, data: { testid: "resend-confirmation-form" }) do |f| %>
        <%= render "devise/shared/error_messages", resource: resource %>

        <div class="crayons-field mt-2">
          <%= f.email_field :email, tgclass: "crayons-textfield", aria: { label: "Confirmation email address" }, autofocus: false, value: proper_email %>
        </div>

        <div class="crayons-field mt-2">
          <%= f.submit "Resend confirmation instructions", class: "crayons-btn" %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
